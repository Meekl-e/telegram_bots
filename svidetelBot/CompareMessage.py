import re

titles = {-1:'‚¨áÔ∏è –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ ‚¨áÔ∏è',
          88: 'üé≠ –ü–æ—Å–ª–µ–¥–Ω—è—è –∞—Ñ–∏—à–∞ üé≠',
          676: 'üïµ –†—É–±—Ä–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å üïµ',
          1726: 'üíµ –ù–æ–≤–æ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å–∞ üíµ',
          29: 'üåç –ù–æ–≤–æ—Å—Ç–∏ –≤ —Ä–µ–≥–∏–æ–Ω–µ üåç',
          4: '‚¨áÔ∏è –†—É–±—Ä–∏–∫–∞ –≤–ª–∞—Å—Ç—å ‚¨áÔ∏è',
          27: '‚ö°–ì–æ—Ä–æ–¥—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ‚ö°',
          6: 'üåç –†—É–±—Ä–∏–∫–∞ –∂–∏–∑–Ω—å üåç',
          26: '‚ù§Ô∏è –ù–æ–≤–æ—Å—Ç–∏ –∑–¥–æ—Ä–æ–≤—å—è ‚ù§Ô∏è',

          51: 'üìñ –ù–æ–≤–æ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è üìñ',
          7: '‚¨áÔ∏è –†—É–±—Ä–∏–∫–∞ –ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è ‚¨áÔ∏è ',
          1038: '‚öñÔ∏è –†—É–±—Ä–∏–∫–∞ "–ü—Ä–∞–≤–æ" ‚öñÔ∏è',
          25: 'üí™ –ù–æ–≤–æ—Å—Ç–∏ —Å–ø–æ—Ä—Ç–∞ ü•á',
          23: 'üèõÔ∏è –ù–æ–≤–æ—Å—Ç–∏ –∫—É–ª—å—Ç—É—Ä—ã üèõÔ∏è',
          3:'üöó –ü–æ—Å–ª–µ–¥–Ω–∏–µ –î–¢–ü üöó\n<i>(–ü–æ –¥–∞–Ω–Ω—ã–º —Å–∞–π—Ç–∞ autoberdsk.ru)</i>'}


def compare_message(title,listNews):
    string = ""
    if len(listNews) == 0:
        return titles[title] + "\n\n" + "<i>–ü–æ—Ö–æ–∂–µ, —Å–µ–≥–æ–¥–Ω—è –≤ –º–æ–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –Ω–µ –±—ã–ª–æ –Ω–æ–≤–æ—Å—Ç–µ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é. </i>"
    for i in range(len(listNews)):
        string += f"{i+1}. ‚û°Ô∏è " + str(listNews[i][1]) + f" |<i>{listNews[i][2]}</i>" +"\n\n"

    return titles[title]+"\n\n"+string + "<b>–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ—Å—Ç–∏:</b>"

def compareStartMessage(name, hi=True):
    if hi:
        return f"""<b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {name}!</b>\n–í—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–°–≤–∏–¥–µ—Ç–µ–ª—è".\n–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–∑–Ω–∞—Ç—å –æ –î–¢–ü –Ω–∞ –ë–µ—Ä–¥—Å–∫–æ–º —à–æ—Å—Å–µ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –ë–µ—Ä–¥—Å–∫–∞.\n\n<b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å —Ä—É–±—Ä–∏–∫—É:</b>"""
    return """–í—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ <b>"–°–≤–∏–¥–µ—Ç–µ–ª—è"</b>.\n–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–∑–Ω–∞—Ç—å –æ –î–¢–ü –Ω–∞ –ë–µ—Ä–¥—Å–∫–æ–º —à–æ—Å—Å–µ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –ë–µ—Ä–¥—Å–∫–∞.\n\n<b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å —Ä—É–±—Ä–∏–∫—É:</b>"""
def compare_news(title, content, date):
    content = re.sub(pattern=r'</*[a-z].*?>', repl='', string=content)
    content = re.sub(pattern=r'&nbsp;', repl=' ', string=content)

    try:
        idx = content.index("<!--more-->")
        return f"<b>{title}</b>\n\n{content[:idx]}<i>{re.sub('-', '.', date)}</i>"
    except ValueError:
        try:
            idx = len(content) - content[::-1].index("–æ—Ç–æ–§") - 4
            content = content[:idx]
        except ValueError:
            pass
        s = content.split()
        if len(s) > 100:
            content = " ".join(s[:100])+"..."
        content= re.sub(r'\n\n\n','\n', content)
        return f"<b>{title}</b>\n\n{content}\n<i>{re.sub('-', '.', date)}</i>"

def compareAllNew(new):
    title = new[1]
    content = new[2]
    date = new[3]
    content = re.sub(pattern=r'</*[a-z].*?>', repl='', string=content)
    content = re.sub(pattern=r'&nbsp;', repl=' ', string=content)
    content = re.sub(pattern="<!--more-->",repl="", string=content)
    try:
        idx = len(content) - content[::-1].index("–æ—Ç–æ–§") - 4
        content = content[:idx]
    except ValueError:
        pass
    lTitle = len(title)
    if len(content) + lTitle > 4096:
        content = content[:4091-lTitle]
        return f"<b>{title}</b>\n\n{content}..."
    return f"<b>{title}</b>\n\n{content}<i>{date}</i>"




def getPhoto(content):

    string = re.search(r'https://.*/uploads/.*">', content)
    if string == None:
        return None

    return string[0][:-2]

def notFoundNews():
    return "<b>–•–º–º...</b> \n –°—Ç—Ä–∞–Ω–Ω–æ. –ù–æ–≤–æ—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. \n <i>–í–æ–∑–º–æ–∂–Ω–æ, –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –Ω–∞–π—Ç–∏ —É–¥–∞–ª–µ–Ω–Ω—É—é/–∏–∑–º–µ–Ω–µ–Ω–Ω—É—é –Ω–æ–≤–æ—Å—Ç—å.</i>\n\n"

def choiceRubrick(rubricks):

    string = ""
    for i, rubrick in enumerate(rubricks.keys()):
        string += f"{i+1}. ‚û°Ô∏è " + str(rubricks[rubrick]) + "\n\n"

    return f"""–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å —Ä—É–±—Ä–∏–∫—É.\n<b>–í—Å–µ —Ä—É–±—Ä–∏–∫–∏:</b>\n\n{string}"""


def compareAbout():
    return "–î–∞–Ω–Ω—ã–π –±–æ—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω –æ–±—ã—á–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º –¥–ª—è –≤–∞—à–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞. –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Å —Ä–µ–¥–∞–∫—Ü–∏–µ–π –≥–∞–∑–µ—Ç—ã '–°–≤–∏–¥–µ—Ç–µ–ª—å' –∏ —Å–∞–π—Ç–æ–º '–ê–≤—Ç–æ–ë–µ—Ä–¥—Å–∫'.\n\n–û—á–µ–Ω—å –∂–¥—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –±–æ—Ç–∞. –¢–∞–∫–∂–µ –±—É–¥—É –æ—á–µ–Ω—å –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏ –∏ –æ—à–∏–±–∫–∏.\n–í—ã –º–æ–∂–µ—Ç–µ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –∫–æ–º–∞–Ω–¥–æ–π <i>/rate [–≤–∞—à –æ—Ç–∑—ã–≤]</i>\n\n–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ‚ù§Ô∏è\n<i>–í–µ—Ä—Å–∏—è ALPHA-1.1</i>"